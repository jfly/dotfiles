#!/bin/bash

set -e

# https://wiki.archlinux.org/index.php/Mouse_acceleration
xset m 2.5 0

# Turn off capslock just in case it's on.
# Normally, I run fixinputs right after noticing that my capslock key is
# actually doing capslock and not escape. I then run fixinputs, and it's
# nice for fixinputs to actually disable capslock, because I didn't want
# it on in the first place!
capslockx off

# Speed up keyrepeat
xset r rate 200 30

# First reset keys before running xmodmap.
setxkbmap
xmodmap ~/.Xmodmap

# Experimenting with xcape https://github.com/alols/xcape
# Map an unused modifier's keysym to the spacebar's keycode and make it a
# control modifier. It needs to be an existing key so that emacs won't
# spazz out when you press it. Hyper_L is a good candidate.
spare_modifier="Hyper_L"
xmodmap -e "keycode 65 = $spare_modifier"
#<<< xmodmap -e "remove mod4 = $spare_modifier" # hyper_l is mod4 by default
#<<< xmodmap -e "add Control = $spare_modifier"

# Map space to an unused keycode (to keep it around for xcape to
# use).
xmodmap -e "keycode any = space"

# Finally use xcape to cause the space bar to generate a space when tapped.
xcape -e "$spare_modifier=space"
